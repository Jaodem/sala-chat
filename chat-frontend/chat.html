<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chat | Sala Chat</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script type="module" src="https://cdn.jsdelivr.net/npm/emoji-picker-element@^1/index.js"></script>
</head>

<body class="h-screen flex flex-col bg-gray-100">

    <!-- NavBar -->
    <nav class="bg-white shadow-lg p-4 flex justify-between items-center border-b z-10 sticky top-0">
        <a href="perfil.html" class="text-blue-600 font-semibold hover:underline">
            Perfil
        </a>

        <div id="statusMessage" class="text-sm text-gray-600">
            <!-- AquÃ­ irÃ¡n mensajes de conecciones -->
        </div>

        <button id="logoutBtn" class="text-red-600 font-semibold hover:underline">
            Cerrar sesiÃ³n
        </button>
    </nav>

    <!-- Contenido principal -->
    <main class="flex flex-1 overflow-hidden">

        <!-- Lista de usuarios -->
        <aside class="w-1/3 max-w-xs bg-white border-r flex flex-col">
            <h2 class="text-lg font-semibold p-4 border-b">
                Usuarios conectados
            </h2>
            <!--  flexâ€‘1  +  overflowâ€‘yâ€‘auto  â‡’ ocupa todo lo que queda y scrollea -->
            <ul id="userList" class="flex-1 overflow-y-auto divide-y">
                <!-- AquÃ­ se insertarÃ¡n los usuarios por JS -->
            </ul>
        </aside>

        <!-- Ventana de chat -->
        <section class="flex-1 flex flex-col">
            <!-- Encabezado del chat -->
            <header class="bg-white p-4 border-b">
                <h2 id="chatWith" class="text-lg font-semibold text-gray-800">
                    SeleccionÃ¡ un usuario
                </h2>
                <p id="typingIndicator" class="text-sm text-gray-500 h-5"></p>
            </header>

            <!-- Mensajes: crecen y hacen scroll -->
            <div id="messageContainer" class="flex flex-col gap-2 p-4 overflow-y-auto h-full">
                <!-- Mensajes renderizados por JS -->
            </div>

            <!-- Input para enviar mensajes, siempre visible abajo -->
            <form id="messageForm" class="border-t bg-white p-4 flex gap-2">
                <!-- BotÃ³n para mostrar/ocultar emoji picker -->
                <button id="emojiToggle" type="button" class="text-2xl">
                    ðŸ˜ƒ
                </button>
                <emoji-picker id="emojiPicker" class="absolute bottom-16 right-5 z-50 shadow-lg hidden"></emoji-picker>
                <input type="text" id="messageInput" placeholder="EscribÃ­ tu mensaje..."
                    class="flex-1 px-4 py-2 border rounded-xl focus:outline-none focus:ring focus:border-blue-300"
                    autocomplete="off" />
                <button id="sendBtn" type="submit" class="bg-blue-600 text-white px-6 py-2 rounded-xl hover:bg-blue-700 transition">
                    Enviar
                </button>
            </form>

            <!-- BotÃ³n flotante para bajar al final -->
            <button id="scrollToBottomBtn"
                    class="hidden fixed bottom-20 right-6 bg-yellow-500 text-white px-4 py-2 rounded-full shadow-lg hover:bg-yellow-600 transition z-20">
                â–¼ Nuevos mensajes
            </button>
        </section>
    </main>

    <audio id="notificationSound" src="./public/sounds/notification.mp3" preload="auto"></audio>

    <script type="module" src="./js/pages/chat.js"></script>
</body>

</html>